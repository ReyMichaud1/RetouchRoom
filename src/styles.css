:root{
  --bg:#f6f7fb; --card:#fff; --text:#0f172a; --muted:#64748b;
  --brand:#0d8dea; --btn:#111827; --danger:#b91c1c; --border:#e5e7eb;
  --active:#10b981;
}
*{box-sizing:border-box}
html,body,#root{height:100%}
html,body{margin:0;background:var(--bg);color:var(--text);font-family:-apple-system,system-ui,Segoe UI,Roboto,sans-serif}

/* Top bar */
.topbar{background:var(--brand);color:#fff;padding:12px 16px;display:flex;align-items:center;gap:12px;min-height:56px}
.brand{font-weight:700;font-size:18px;flex:1}
.nav{display:flex;align-items:center;gap:8px}
.navlink{color:#fff;text-decoration:none}
.dot{opacity:.35;color:#fff}

/* Layout cards */
.wrap{max-width:980px;margin:18px auto;padding:0 12px}
.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px;margin-bottom:14px}
h2{margin:0 0 10px 0;font-size:16px}
input,textarea,select{
  display:block;width:100%;max-width:540px;padding:8px 10px;margin:6px 0;
  border:1px solid var(--border);border-radius:8px;font-size:14px;background:#fff;color:var(--text)
}
.textarea{max-width:none}
.select{max-width:none}
button{background:var(--btn);color:#fff;border:none;border-radius:10px;padding:8px 12px;cursor:pointer;font-size:14px}
button.danger{background:var(--danger)}
.muted{color:var(--muted);font-size:13px}
.spacer{flex:1}
.row{display:flex;gap:8px;flex-wrap:wrap}
.dropbox{color:#0d8dea;text-decoration:none}

/* Tool buttons */
button.tool{
  background:var(--btn);
  border:1px solid transparent;
  transition:background .15s ease, transform .05s ease, box-shadow .15s ease;
}
button.tool.active{
  background:var(--active);
  box-shadow:0 0 0 2px rgba(16,185,129,.25) inset;
}
button.tool:active{ transform: translateY(1px); }

/* Tiny variants for the floating toolbar */
button.tool.xs{ padding:4px 6px; font-size:12px; border-radius:8px; }
input.xs.range{ width:100px; height:20px; margin:0 4px; }
input.xs.color{ width:26px; height:26px; padding:0; border:none; background:transparent; }

/* Lists */
.project{display:flex;align-items:center;gap:8px;padding:10px;margin:6px 0;border:1px solid var(--border);border-radius:10px;background:#fff}
.project-name{font-weight:600}

/* Images grid */
.grid.images{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px}
.img-tile{display:flex;flex-direction:column;border:1px solid var(--border);border-radius:14px;background:#fff;overflow:visible}
.img-tile img{width:100%;height:180px;object-fit:cover;border-top-left-radius:14px;border-top-right-radius:14px;display:block}
.img-meta{display:flex;justify-content:space-between;gap:8px;padding:8px 10px}
.img-name{font-weight:600;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:70%}
.img-size{color:var(--muted);font-size:12px}
.img-actions{display:grid;grid-template-columns:1fr 1fr;gap:8px;padding:8px 10px 12px 10px}

/* Upload dropzone */
.dropzone{border:2px dashed var(--border);border-radius:12px;padding:24px;text-align:center;background:#fafafa}
.dropzone.is-dragging{background:#eef6ff;border-color:#bcdcff}
.dropzone.is-uploading{opacity:.7;pointer-events:none}

/* Viewer fills the whole screen under the blue bar */
.viewer{
  position:fixed; left:0; right:0; bottom:0; top:56px;
  display:grid; grid-template-columns:1fr 320px; min-height:0;
}
.left{display:grid;grid-template-rows:1fr auto;border-right:1px solid var(--border);min-height:0}
.right{display:grid;grid-template-rows:auto 1fr auto;min-height:0}

/* Big drawing area */
.viewport{position:relative;background:#111;overflow:hidden;user-select:none;min-height:0;height:100%;cursor:crosshair}

/* Floating compact tools */
.floating-tools{
  position:absolute; left:10px; top:10px; z-index:10;
  background:rgba(17,24,39,.86); color:#fff;
  padding:6px; border-radius:12px; display:flex; align-items:center; gap:6px;
  backdrop-filter: blur(6px);
}
.floating-tools .danger{ background:#7f1d1d; }

/* Comments */
.comment{border:1px solid var(--border);border-radius:10px;padding:10px;margin-bottom:8px;background:#fff;transition:background .15s ease, box-shadow .15s ease, border-color .15s}
.comment-head{display:flex;align-items:center;gap:8px}
.comment-link{font-size:12px;color:var(--muted);margin-bottom:4px;flex:1}
.comment.active{ background:#eef6ff; border-color:var(--brand); box-shadow:0 0 0 2px rgba(13,141,234,.2) inset; }
button.icon{ background:var(--btn); color:#fff; border:none; border-radius:8px; font-size:12px; padding:4px 6px; }

/* Reference attachment UI */
.ref-row{display:flex;gap:8px;align-items:center;margin-top:6px}
.ref-preview{margin-top:8px}
.ref-thumb{width:100%;max-height:160px;object-fit:cover;border:1px solid var(--border);border-radius:8px;display:block}

/* Toast */
.toast{
  position: fixed;
  right: 16px;
  bottom: 16px;
  background:#065f46;
  color:#fff;
  padding:10px 12px;
  border-radius:12px;
  box-shadow:0 10px 28px rgba(0,0,0,.2);
  z-index: 9999;
  font-size:14px;
}
.toast.err{ background:#7f1d1d; }
